<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Secure Message App (media)</title>
  <style>
    :root{--primary:#007bff;--bg:#f7f9fc;--card:#fff;--text:#222;--muted:#6b7280}
    body{margin:0;padding:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial;background:var(--bg);color:var(--text);display:flex;justify-content:center;align-items:flex-start;min-height:100vh}
    .container{width:100%;max-width:520px;padding:20px;box-sizing:border-box}
    h1{text-align:center;margin:6px 0 18px;color:var(--primary);font-size:20px}
    form{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);margin-bottom:16px}
    label{display:block;font-weight:600;margin-top:8px;font-size:13px;color:var(--muted)}
    textarea,input,select,button{width:100%;box-sizing:border-box;margin-top:8px;padding:12px;font-size:14px;border-radius:8px;border:1px solid #d1d5db}
    textarea{min-height:90px;resize:vertical}
    button{background:var(--primary);color:#fff;border:none;cursor:pointer;font-weight:700}
    button.secondary{background:#6b7280}
    #encryptedLink,#decryptedOutput{margin-top:12px;padding:12px;border-radius:8px;background:#e8f5ff;border:1px solid rgba(0,123,255,0.15);word-break:break-word;font-size:14px}
    #toast{visibility:hidden;min-width:220px;background:#111;color:#fff;text-align:center;border-radius:6px;padding:10px 14px;position:fixed;left:50%;transform:translateX(-50%);bottom:26px;opacity:0;transition:opacity .35s,bottom .35s;z-index:9999}
    /* dark */
    body.dark{--bg:#0b1020;--card:#0f1724;--text:#e6eef8;--muted:#9aa6bd;--primary:#3b82f6}
    body.dark form{box-shadow:none;border:1px solid rgba(255,255,255,0.03)}
    body.dark #encryptedLink,body.dark #decryptedOutput{background:#071025;border:1px solid rgba(255,255,255,0.03);color:var(--text)}
    #darkModeToggle{position:fixed;top:12px;right:12px;width:44px;height:44px;border-radius:999px;border:none;cursor:pointer;background:#111;color:#fff;font-size:18px;z-index:999}
    body.dark #darkModeToggle{background:#fff;color:#111}
    .meta{font-size:13px;color:var(--muted);margin-top:8px}
    @media(max-width:520px){.container{padding:14px}}
  </style>
</head>
<body>
  <button id="darkModeToggle" title="Toggle dark mode">üåô</button>

  <div class="container">
    <h1>üîê Secure Message ‚Äî Text & Media</h1>

    <!-- ENCRYPT -->
    <form id="encryptForm" aria-label="encrypt form">
      <label for="message">Message (optional)</label>
      <textarea id="message" placeholder="Type a message to accompany the file..."></textarea>

      <label for="file">Attach file (optional, images/audio/video/document)</label>
      <input id="file" type="file" accept="image/*,video/*,audio/*,application/pdf,application/*" />

      <label for="allowDownload">
        <input id="allowDownload" type="checkbox" /> Allow recipient to download file
      </label>

      <label for="passcode">Passcode (shared secret)</label>
      <input id="passcode" type="password" placeholder="Enter a passcode" required />

      <label for="expiry">Message Expiry</label>
      <select id="expiry">
        <option value="none">No expiry</option>
        <option value="burn">üî• Burn after Reading</option>
        <option value="1">üëÅ One-time View</option>
        <option value="24h">‚è≥ 24 hours</option>
      </select>

      <div class="meta">Note: URLs with embedded files must be small (‚â§ ~150KB) to work reliably across chat apps. For larger files use a server upload (available later).</div>
      <button type="submit">Encrypt & Generate Link</button>
      <div id="encryptedLink" aria-live="polite"></div>
    </form>

    <!-- DECRYPT -->
    <form id="decryptForm" style="display:none;" aria-label="decrypt form">
      <!-- expiry info injected dynamically -->
      <label for="decryptPasscode">Enter Passcode</label>
      <input id="decryptPasscode" type="password" placeholder="Enter the passcode" required />
      <div style="display:flex;gap:8px;margin-top:8px;">
        <button type="submit">Decrypt</button>
        <button id="pastePasscode" type="button" class="secondary">üìã Paste</button>
      </div>
      <div id="decryptedOutput" aria-live="polite"></div>
    </form>
  </div>

  <div id="toast" role="status" aria-live="polite">Copied</div>

  <script src="/app.js"></script>
</body>
</html>